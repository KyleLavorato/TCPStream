RTPS_Generated.h
90,102d89
<     HEADER_RTPS header;
<     GUIDPREFIX_RTPS guidprefix;
<     unsigned long submsglength;
<     unsigned long submsgcount;
< } FULL_RTPS;
< typedef struct {
<     uint32_t type;
<     union {
<         FULL_RTPS full_rtps;
<         PING_RTPS ping_rtps;
<     } ptr;
< } PDU_RTPS;
< typedef struct {
537,549d523
<     unsigned long serializeddata_length;
<     unsigned char *serializeddata;
< } DATASUB_RTPS;
< typedef struct {
<     uint8_t kind;
<     uint8_t flags;
<     uint16_t nextheader;
<     uint16_t extraflags;
<     uint16_t qosoffset;
<     ENTITYID_RTPS readerent;
<     ENTITYID_RTPS writerent;
<     uint64_t writerseq;
<     QOSPARM_RTPS *inlineqos;
637a612,624
>     uint8_t kind;
>     uint8_t flags;
>     uint16_t nextheader;
>     uint16_t extraflags;
>     uint16_t qosoffset;
>     ENTITYID_RTPS readerent;
>     ENTITYID_RTPS writerent;
>     uint64_t writerseq;
>     QOSPARM_RTPS *inlineqos;
>     unsigned long serializeddata_length;
>     unsigned char *serializeddata;
> } DATASUB_RTPS;
> typedef struct {
677,685c664,678
< void DATASUB_RTPS_callback (FULL_RTPS * full_rtps, DATASUB_RTPS * datasub_rtps, PDU * thePDU);
< void DATAWSUB_RTPS_callback (FULL_RTPS * full_rtps, DATAWSUB_RTPS * datawsub_rtps, PDU * thePDU);
< void DATAPSUB_RTPS_callback (FULL_RTPS * full_rtps, DATAPSUB_RTPS * datapsub_rtps, PDU * thePDU);
< void DATARSUB_RTPS_callback (FULL_RTPS * full_rtps, DATARSUB_RTPS * datarsub_rtps, PDU * thePDU);
< void INFO$DST_RTPS_callback (FULL_RTPS * full_rtps, INFO$DST_RTPS * info$dst_rtps, PDU * thePDU);
< void INFO$TS_RTPS_callback (FULL_RTPS * full_rtps, INFO$TS_RTPS * info$ts_rtps, PDU * thePDU);
< void ACKNACK_RTPS_callback (FULL_RTPS * full_rtps, ACKNACK_RTPS * acknack_rtps, PDU * thePDU);
< void HEARTBEAT_RTPS_callback (FULL_RTPS * full_rtps, HEARTBEAT_RTPS * heartbeat_rtps, PDU * thePDU);
< void GAP_RTPS_callback (FULL_RTPS * full_rtps, GAP_RTPS * gap_rtps, PDU * thePDU);
---
> typedef struct {
>     HEADER_RTPS header;
>     GUIDPREFIX_RTPS guidprefix;
>     unsigned long submsglength;
>     unsigned long submsgcount;
>     SUBMESSAGE_RTPS *submsg;
> } FULL_RTPS;
> typedef struct {
>     uint32_t type;
>     union {
>         FULL_RTPS full_rtps;
>         PING_RTPS ping_rtps;
>     } ptr;
> } PDU_RTPS;
> void FULL_RTPS_callback (FULL_RTPS * full_rtps, PDU * thePDU);
688,696d680
< void freeDATASUB_RTPS (DATASUB_RTPS * datasub_rtps);
< void freeDATAWSUB_RTPS (DATAWSUB_RTPS * datawsub_rtps);
< void freeDATAPSUB_RTPS (DATAPSUB_RTPS * datapsub_rtps);
< void freeDATARSUB_RTPS (DATARSUB_RTPS * datarsub_rtps);
< void freeINFO$DST_RTPS (INFO$DST_RTPS * info$dst_rtps);
< void freeINFO$TS_RTPS (INFO$TS_RTPS * info$ts_rtps);
< void freeACKNACK_RTPS (ACKNACK_RTPS * acknack_rtps);
< void freeHEARTBEAT_RTPS (HEARTBEAT_RTPS * heartbeat_rtps);
< void freeGAP_RTPS (GAP_RTPS * gap_rtps);
callback.c
1c1
<  #include "cglobals.h"
---
> #include "cglobals.h"
17,18d16
< #define NoPrint
< 
21a20
> 
41,42c40
< 	uint32_t d = (IP & 0xff000000); 
< 	return (d) >= 0xe0000000;
---
> 	return (IP & 0xff000000) >= 224;
47c45
< 	return ((IsGroupAddress(SrcIP) == 0) && (IsGroupAddress(dstIP) == 0));
---
> 	return ((IsGroupAddress(SrcIP) == 1) && (IsGroupAddress(dstIP) == 1));
201,202c199
< 	
< }
---
> 	struct HeaderInfo *h = thePDU->header;
204,205c201,221
< void V2Report_IGMP_callback(V2Report_IGMP * v, PDU * thePDU) {
< 	
---
> 	if (HasValuegroupaddressLists(q->groupaddr) == -1)
> 	{
> 		if (traceFileCons)
> 			fprintf(traceFileCons, "Pakcet %lu: DC1\n", h->pktCount);
> 
> 		if (q->groupaddr == GenerelQueryAddress)
> 		{
> 			int pos = 0;
> 			while (pos < SIZEFactgroupaddressLists)
> 			{
> 				if (factsgroupaddressLists[pos].m_key != 0)
> 					destroyC1(h->srcIP, factsgroupaddressLists[pos].m_key, traceFileCons);
> 				pos++;
> 			}
> 		}
> 		else
> 		{
> 			insertValuegroupaddressLists(q->groupaddr);
> 			destroyC1(h->srcIP, q->groupaddr, traceFileCons);
> 		}
> 	}
208,210c224,225
< void V2Leave_IGMP_callback(V2Leave_IGMP * v, PDU * thePDU) {
< 
< }
---
> void V2Report_IGMP_callback(V2Report_IGMP * v, PDU * thePDU) {
> 	struct HeaderInfo *h = thePDU->header;
212,213c227,255
< void V3Report_IGMP_callback(V3Report_IGMP * v, PDU * thePDU) {
< 	
---
> 	if (HasValuegroupaddressLists(v->groupaddr) == -1)
> 	{
> 		if (traceFileCons)
> 			fprintf(traceFileCons, "Pakcet %lu: IC1", h->pktCount);
> 
> 		if (instantiateC1(h->srcIP, v->groupaddr, h->srcIP, traceFileCons) != -1) //IsInTree
> 		{
> 			if (traceFileCons)
> 				fprintf(traceFileCons, "Pakcet %lu: BC1", h->pktCount);
> 
> 			if (bindC1(h->srcIP, v->groupaddr, h->srcIP, traceFileCons) != -1) //IsInTree
> 			{
> 				evaluateC1(h->srcIP, v->groupaddr, h->srcIP, traceFileCons);
> 				if (traceFileCons)
> 					fprintf(traceFileCons, "Pakcet %lu: BC1", h->pktCount);
> 			}
> 		}
> 	}
> 
> 	if (traceFileCons)
> 		fprintf(traceFileCons, "\tIC5\n");
> 
> 	if (v->groupaddr == GenerelQueryAddress)
> 	{
> 		for (int i = 0; i < SIZEFactgroupaddressLists; i++)
> 			instantiateC5(h->srcIP, factsgroupaddressLists[i].m_key, h->srcIP, traceFileCons);
> 	}
> 	else
> 		instantiateC5(h->srcIP, v->groupaddr, h->srcIP, traceFileCons);
216,220c258,259
< void FULL_RTPS_callback(FULL_RTPS * r, PDU * thePDU) 
< {
< 	fprintf(traceFile,"\t(Full callback reached)");
< 
< }
---
> void V2Leave_IGMP_callback(V2Leave_IGMP * v, PDU * thePDU) {
> 	struct HeaderInfo *h = thePDU->header;
222c261,286
< // ADDED FROM ORIGINAL //
---
> 	if (v->groupaddr == GeneralleaveAddress)
> 	{
> 			int pos = 0;
> 			while (pos < SIZEFactgroupaddressLists)
> 			{
> 				if (factsgroupaddressLists[pos].m_key != 0)
> 				{
> 					destroyC7a(h->srcIP, factsgroupaddressLists[pos].m_key, h->srcPort, traceFileCons);
> 					destroyC7b(h->srcIP, factsgroupaddressLists[pos].m_key, h->srcPort, traceFileCons);
> 					destroyC5(h->srcIP, factsgroupaddressLists[pos].m_key, traceFileCons);
> 
> 					if (traceFileCons)
> 						fprintf(traceFileCons, "Pakcet %lu: DC7a\tDC7b\tDC5", h->pktCount);
> 				}
> 				pos++;
> 			}
> 	}
> 	else
> 	{
> 		destroyC7a(h->srcIP, v->groupaddr, h->srcPort, traceFileCons);
> 		destroyC7b(h->srcIP, v->groupaddr, h->srcPort, traceFileCons);
> 		destroyC5(h->srcIP, v->groupaddr, traceFileCons);
> 
> 		if (traceFileCons)
> 			fprintf(traceFileCons, "Pakcet %lu: DC7a\tDC7b\tDC5", h->pktCount);
> 	}
224,226c288
< void DATAPSUB_RTPS_callback (FULL_RTPS * full_rtps, DATAPSUB_RTPS * datapsub_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | DATAPSUB");
< }
---
> 	destroyC11(h->srcIP, h->srcPort, traceFileCons);
228,229c290,291
< void DATASUB_RTPS_callback (FULL_RTPS * full_rtps, DATASUB_RTPS * datasub_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | DATASUB");
---
> 	if (traceFileCons)
> 		fprintf(traceFileCons, "\tDC11\n");
232,234c294,295
< void ACKNACK_RTPS_callback (FULL_RTPS * full_rtps, ACKNACK_RTPS * acknack_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | ACKNACK");
< }
---
> void V3Report_IGMP_callback(V3Report_IGMP * v, PDU * thePDU) {
> 	struct HeaderInfo *h = thePDU->header;
236,239c297,321
< void HEARTBEAT_RTPS_callback (FULL_RTPS * full_rtps, HEARTBEAT_RTPS * heartbeat_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | HEARTBEAT");
< 	//walkFULLRTPS(full_rtps);
< 	//walkHEARTBEAT(heartbeat_rtps);
---
> 	for (int i = 0; i < v->numgrps; i++)
> 	{
> 		uint32_t groupaddress  = v->grouprecordinfo[i].groupaddr;
> 		if (v->grouprecordinfo[i].recordtype == 3)
> 		{
> 			destroyC7a(h->srcIP, groupaddress, h->srcPort, traceFileCons);
> 			destroyC7b(h->srcIP, groupaddress, h->srcPort, traceFileCons);
> 			destroyC5(h->srcIP, groupaddress, traceFileCons);
> 		    destroyC11(h->srcIP,  h->srcPort, traceFileCons);
> 
> 			if (traceFileCons)
> 				fprintf(traceFileCons, "Pakcet %lu: DC7a\tDC7b\tDC5\tDC11", h->pktCount);	
> 		}
> 		else
> 		{
> 			if (HasValuegroupaddressLists(groupaddress) == -1)
> 			{
> 				if (instantiateC1(h->srcIP, groupaddress, h->srcIP, traceFileCons) != -1) //IsInTree
> 				{
> 					if (bindC1(h->srcIP, groupaddress, h->srcIP, traceFileCons) != -1) //IsInTree
> 						evaluateC1(h->srcIP, groupaddress, h->srcIP, traceFileCons);
> 				}
> 			}
> 		}
> 	}
242,246c324,447
< void INFO$DST_RTPS_callback (FULL_RTPS * full_rtps, INFO$DST_RTPS * info$dst_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | INFO_DST");
< 	//walkFULLRTPS(full_rtps);
< 	//walkINFO$DST(info$dst_rtps);
< }
---
> void FULL_RTPS_callback(FULL_RTPS * r, PDU * thePDU) 
> {
> 	struct HeaderInfo *h = thePDU->header;
> 	for(int i = 0; i < r->submsgcount; i++)
> 	{
> 		unsigned char* topicname = NULL;
> 		if (r->submsg[i].type == DATAWSUB_RTPS_VAL)
> 		{
> 				TOPICS_RTPS* topic_parms = r->submsg[i].ptr.datawsub_rtps.serializeddata;
> 				if (topic_parms == NULL)
> 					continue;
> 				
> 				for (int topic = 0; topic < topic_parms->topicdatacount; topic++)
> 				{
> 					if (topic_parms->topicdata[topic].type == PIDTOPICNAME_RTPS_VAL)
> 					{
> 						topicname = topic_parms->topicdata[topic].ptr.pidtopicname_rtps.topicname.name;
> 						break;
> 					}
> 				}
> 
> 				assert(topicname != NULL);
> 				uint32_t topic_key =  hashForString((const char*)topicname);
> 
> 				uint32_t* c = (uint32_t*) malloc(sizeof(uint32_t) * 8);
> 				memset(c, 0, sizeof(uint32_t));
> 					
> 
> 				for (int topic = 0; topic < topic_parms->topicdatacount; topic++)
> 				{
> 					if (topic_parms->topicdata[topic].type == PIDOWNERSHIPSTRENGTH_RTPS_VAL)
> 						c[0] = topic_parms->topicdata[topic].ptr.pidownershipstrength_rtps.strength_length;
> 					else if (topic_parms->topicdata[topic].type == PIDPERSISTENCE_RTPS_VAL)
> 						c[1] = topic_parms->topicdata[topic].ptr.pidpersistence_rtps.leaseduration_length;
> 					else if (topic_parms->topicdata[topic].type == PIDLIFESPAN_RTPS_VAL)
> 						c[2] = topic_parms->topicdata[topic].ptr.pidlifespan_rtps.leaseduration_length;
> 					else if (topic_parms->topicdata[topic].type == PIDDEADLINE_RTPS_VAL)
> 						c[3] = topic_parms->topicdata[topic].ptr.piddeadline_rtps.leaseduration_length;
> 					else if (topic_parms->topicdata[topic].type == PIDLIVELINESS_RTPS_VAL)
> 						c[4] = topic_parms->topicdata[topic].ptr.pidliveliness_rtps.liveliness_length;
> 					else if (topic_parms->topicdata[topic].type == PIDLATENCYBUDGET_RTPS_VAL)
> 						c[5] = topic_parms->topicdata[topic].ptr.pidlatencybudget_rtps.leaseduration_length;
> 					else if (topic_parms->topicdata[topic].type == PIDTYPECODE_RTPS_VAL)
> 						c[6] = topic_parms->topicdata[topic].ptr.pidtypecode_rtps.parameterkind;
> 					else if (topic_parms->topicdata[topic].type == PIDTYPECONSISTENCY_RTPS_VAL)
> 						c[7] = topic_parms->topicdata[topic].ptr.pidtypeconsistency_rtps.parameterlength;
> 				}
> 
> 
>                 int ieval = 1;
> 				if (evaluateC7b(h->srcIP, h->dstIP, h->srcPort, topic_key, traceFileCons) == -1)
> 				{
> 					(int)instantiateC7a(h->srcIP, h->dstIP, h->srcPort, topic_key, traceFileCons);
> 					ieval = 1;
> 				}
> 
> 				evaluateC5(h->srcIP, h->dstIP, h->srcIP, traceFileCons);
> 				evaluateC8(h->srcIP, h->dstIP, topic_key, c, traceFileCons);
> 				instantiateC11(topic_key, h->srcPort, h->srcIP, traceFileCons);
> 
> 				if (traceFileCons)
> 				{
> 					if (ieval == 1)
> 						fprintf(traceFileCons, "Pakcet %lu: EC7b", h->pktCount);
> 					else
> 						fprintf(traceFileCons, "Pakcet %lu: IC7a", h->pktCount);
> 
> 					fprintf(traceFileCons, "\tEC5\tEC8\tIC11\n");	
> 				}
> 		}
> 		else if (r->submsg[i].type == DATARSUB_RTPS_VAL)
> 		{
> 				TOPICS_RTPS* topic_parms = r->submsg[i].ptr.datarsub_rtps.serializeddata;
> 				if (topic_parms == NULL)
> 					continue;		
> 
> 				for (int topic = 0; topic < topic_parms->topicdatacount; topic++)
> 				{
> 					if (topic_parms->topicdata[topic].type == PIDTOPICNAME_RTPS_VAL)
> 					{
> 						topicname = topic_parms->topicdata[topic].ptr.pidtopicname_rtps.topicname.name;
> 						break;
> 					}
> 				}
> 
> 				assert(topicname != NULL);
> 				uint32_t topic_key =  hashForString((const char*)topicname);
> 
> 				int ieval = 1;
> 				if (evaluateC7a(h->srcIP, h->dstIP, h->srcPort, topic_key, traceFileCons) == -1)
> 				{
> 					(int)instantiateC7b(h->srcIP, h->dstIP, h->srcPort, topic_key, traceFileCons);
> 					ieval = 0;
> 				}
> 
> 				evaluateC5(h->srcIP, h->dstIP, h->srcIP, traceFileCons);
> 				bindC11(topic_key, h->srcPort, h->srcIP, h->srcIP, 1, traceFileCons);
> 
> 				if (traceFileCons)
> 				{
> 					if (ieval == 1)
> 						fprintf(traceFileCons, "Pakcet %lu: EC7a", h->pktCount);
> 					else
> 						fprintf(traceFileCons, "Pakcet %lu: IC7b", h->pktCount);
> 
> 					fprintf(traceFileCons, "\tEC5");	
> 					fprintf(traceFileCons, "\tIC11\n");				
> 				}
> 		}
> 
> 		else if (r->submsg[i].type == DATAPSUB_RTPS_VAL)
> 		{
> 			bindC5(h->srcIP, h->dstIP, h->srcIP, traceFileCons);
> 
> 			if (traceFileCons)
> 				fprintf(traceFileCons, "Pakcet %lu: BC5\n", h->pktCount);
> 		}
> 		else if (r->submsg[i].type == DATASUB_RTPS_VAL)
> 		{
> 			if (IsUniCastChannel(h->srcIP, h->dstIP))
> 			{
> 				uint32_t tokenID = GetValueFact8(h->srcIP, h->srcPort);
> 				if (tokenID != -1)
> 					evaluateC11(tokenID, h->srcPort, h->dstIP, h->srcIP, h->dstIP, traceFileCons);
248,250c449,450
< void INFO$TS_RTPS_callback (FULL_RTPS * full_rtps, INFO$TS_RTPS * info$ts_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | INFO_TS");
< }
---
> 				if (traceFileCons)
> 					fprintf(traceFileCons, "Pakcet %lu: EC11\n", h->pktCount);
252,254c452,453
< void DATAWSUB_RTPS_callback (FULL_RTPS * full_rtps, DATAWSUB_RTPS * datawsub_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | DATAWSUB");
< }
---
> 			}
> 		}
256,258c455
< void DATARSUB_RTPS_callback (FULL_RTPS * full_rtps, DATARSUB_RTPS * datarsub_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | DATARSUB");
< }
---
> 	}
260,261d456
< void GAP_RTPS_callback (FULL_RTPS * full_rtps, GAP_RTPS * gap_rtps, PDU * thePDU) {
< 	if (traceFile) fprintf(traceFile," | GAP");
264d458
< // END ADDED //
267,269d460
< 
< 
< 
RTPS_Generated.c
6,14d5
< void freeDATASUB_RTPS (DATASUB_RTPS *datasub_rtps);
< void freeACKNACK_RTPS (ACKNACK_RTPS *acknack_rtps);
< void freeHEARTBEAT_RTPS (HEARTBEAT_RTPS *heartbeat_rtps);
< void freeINFO$DST_RTPS (INFO$DST_RTPS *info$dst_rtps);
< void freeINFO$TS_RTPS (INFO$TS_RTPS *info$ts_rtps);
< void freeDATAWSUB_RTPS (DATAWSUB_RTPS *datawsub_rtps);
< void freeDATARSUB_RTPS (DATARSUB_RTPS *datarsub_rtps);
< void freeGAP_RTPS (GAP_RTPS *gap_rtps);
< void freeDATAPSUB_RTPS (DATAPSUB_RTPS *datapsub_rtps);
20d10
< bool walk_SUBMESSAGE_RTPS (FULL_RTPS *full_rtps, SUBMESSAGE_RTPS *submessage_rtps, PDU *thePDU);
211a202
>     full_rtps->submsg = NULL;
227,230c218,219
<     SUBMESSAGE_RTPS *submsg;
<     submsg = NULL;
<     submsg = parseSetOfSUBMESSAGE (thePDU, 0, &size, progname, endianness);
<     if (submsg == NULL) {
---
>     full_rtps->submsg = parseSetOfSUBMESSAGE (thePDU, 0, &size, progname, endianness);
>     if (full_rtps->submsg == NULL) {
238,242c227
<     walk_SUBMESSAGE_RTPS (full_rtps, submsg, thePDU);
<     if (submsg != NULL) {
<         free (submsg);
<         submsg = NULL;
<     }
---
>     FULL_RTPS_callback (full_rtps, thePDU);
4381,4790c4366,4367
< void freeDATASUB_RTPS (DATASUB_RTPS *datasub_rtps) {
<     if (datasub_rtps->inlineqos != NULL) {
<         if (datasub_rtps->inlineqos->qos != NULL) {
<             for (int j = 0; j < datasub_rtps->inlineqos->qoscount; ++j) {
<                 if (&datasub_rtps->inlineqos->qos [j] != NULL) {
<                     if (datasub_rtps->inlineqos->qos [j].type > 0) {
<                         switch (datasub_rtps->inlineqos->qos [j].type) {
<                         case PIDSTATUSINFO_RTPS_VAL :
<                             {
<                                 if (datasub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
<                                     free (datasub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
<                                     datasub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDKEYHASH_RTPS_VAL :
<                             {
<                                 if (datasub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
<                                     free (datasub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
<                                     datasub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datasub_rtps->inlineqos->qos != NULL) {
<                 free (datasub_rtps->inlineqos->qos);
<                 datasub_rtps->inlineqos->qos = NULL;
<             }
<         }
<     }
<     if (datasub_rtps->inlineqos != NULL) {
<         free (datasub_rtps->inlineqos);
<         datasub_rtps->inlineqos = NULL;
<     }
<     if (datasub_rtps->serializeddata != NULL) {
<         free (datasub_rtps->serializeddata);
<         datasub_rtps->serializeddata = NULL;
<     }
< }
< 
< void freeACKNACK_RTPS (ACKNACK_RTPS *acknack_rtps) {
<     if (acknack_rtps->readersn.bitmap != NULL) {
<         free (acknack_rtps->readersn.bitmap);
<         acknack_rtps->readersn.bitmap = NULL;
<     }
< }
< 
< void freeHEARTBEAT_RTPS (HEARTBEAT_RTPS *heartbeat_rtps) {
< }
< 
< void freeINFO$DST_RTPS (INFO$DST_RTPS *info$dst_rtps) {
< }
< 
< void freeINFO$TS_RTPS (INFO$TS_RTPS *info$ts_rtps) {
< }
< 
< void freeDATAWSUB_RTPS (DATAWSUB_RTPS *datawsub_rtps) {
<     if (datawsub_rtps->inlineqos != NULL) {
<         if (datawsub_rtps->inlineqos->qos != NULL) {
<             for (int j = 0; j < datawsub_rtps->inlineqos->qoscount; ++j) {
<                 if (&datawsub_rtps->inlineqos->qos [j] != NULL) {
<                     if (datawsub_rtps->inlineqos->qos [j].type > 0) {
<                         switch (datawsub_rtps->inlineqos->qos [j].type) {
<                         case PIDSTATUSINFO_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
<                                     free (datawsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
<                                     datawsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDKEYHASH_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
<                                     free (datawsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
<                                     datawsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datawsub_rtps->inlineqos->qos != NULL) {
<                 free (datawsub_rtps->inlineqos->qos);
<                 datawsub_rtps->inlineqos->qos = NULL;
<             }
<         }
<     }
<     if (datawsub_rtps->inlineqos != NULL) {
<         free (datawsub_rtps->inlineqos);
<         datawsub_rtps->inlineqos = NULL;
<     }
<     if (datawsub_rtps->serializeddata != NULL) {
<         if (datawsub_rtps->serializeddata->topicdata != NULL) {
<             for (int j = 0; j < datawsub_rtps->serializeddata->topicdatacount; ++j) {
<                 if (&datawsub_rtps->serializeddata->topicdata [j] != NULL) {
<                     if (datawsub_rtps->serializeddata->topicdata [j].type > 0) {
<                         switch (datawsub_rtps->serializeddata->topicdata [j].type) {
<                         case PIDTOPICNAME_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTYPENAME_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDRELIABILITY_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDENDPOINTGUID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDMULTICASTLOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDUNICASTLOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDUNKNOWN_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDACKKIND_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDRECVQUEUE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTIMEBASEDFILTER_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDLIVELINESS_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDURABILITY_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDIRECTCOMMUNICATION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDOWNERSHIP_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDPRESENTATION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDESTINATIONORDER_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDEADLINE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDLATENCYBUDGET_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDGROUPENTITYID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDENTITYVIRTUALGUID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDSERVICEKIND_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDPROTOVERSION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDPRODUCTVERSION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDISABLEPOSITIVEACKS_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDEXPECTSVIRTUALHB_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDTYPECONSISTENCY_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDTYPEOBJECT_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTYPECODE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDVENDORID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDENTITYNAME_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDEXPECTSACK_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDSENDQUEUESIZE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDOWNERSHIPSTRENGTH_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDPERSISTENCE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDLIFESPAN_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTYPEMAXSIZESERIALIZED_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDURABILITYSERVICE_RTPS_VAL :
<                             {
<                                 if (datawsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice != NULL) {
<                                     free (datawsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice);
<                                     datawsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice = NULL;
<                                 }
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datawsub_rtps->serializeddata->topicdata != NULL) {
<                 free (datawsub_rtps->serializeddata->topicdata);
<                 datawsub_rtps->serializeddata->topicdata = NULL;
<             }
<         }
<     }
<     if (datawsub_rtps->serializeddata != NULL) {
<         free (datawsub_rtps->serializeddata);
<         datawsub_rtps->serializeddata = NULL;
<     }
< }
< 
< void freeDATARSUB_RTPS (DATARSUB_RTPS *datarsub_rtps) {
<     if (datarsub_rtps->inlineqos != NULL) {
<         if (datarsub_rtps->inlineqos->qos != NULL) {
<             for (int j = 0; j < datarsub_rtps->inlineqos->qoscount; ++j) {
<                 if (&datarsub_rtps->inlineqos->qos [j] != NULL) {
<                     if (datarsub_rtps->inlineqos->qos [j].type > 0) {
<                         switch (datarsub_rtps->inlineqos->qos [j].type) {
<                         case PIDSTATUSINFO_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
<                                     free (datarsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
<                                     datarsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDKEYHASH_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
<                                     free (datarsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
<                                     datarsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datarsub_rtps->inlineqos->qos != NULL) {
<                 free (datarsub_rtps->inlineqos->qos);
<                 datarsub_rtps->inlineqos->qos = NULL;
<             }
<         }
<     }
<     if (datarsub_rtps->inlineqos != NULL) {
<         free (datarsub_rtps->inlineqos);
<         datarsub_rtps->inlineqos = NULL;
---
> void freePDU_RTPS (PDU_RTPS *mainpdu) {
>     if (mainpdu->type == PING_RTPS_VAL) {
4792,5006c4369,4411
<     if (datarsub_rtps->serializeddata != NULL) {
<         if (datarsub_rtps->serializeddata->topicdata != NULL) {
<             for (int j = 0; j < datarsub_rtps->serializeddata->topicdatacount; ++j) {
<                 if (&datarsub_rtps->serializeddata->topicdata [j] != NULL) {
<                     if (datarsub_rtps->serializeddata->topicdata [j].type > 0) {
<                         switch (datarsub_rtps->serializeddata->topicdata [j].type) {
<                         case PIDTOPICNAME_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTYPENAME_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDRELIABILITY_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidreliability_rtps.slack = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDENDPOINTGUID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDMULTICASTLOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDUNICASTLOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDUNKNOWN_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDACKKIND_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDRECVQUEUE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTIMEBASEDFILTER_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDLIVELINESS_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDURABILITY_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.piddurability_rtps.durability = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDIRECTCOMMUNICATION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDOWNERSHIP_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidownership_rtps.kind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDPRESENTATION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDESTINATIONORDER_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDDEADLINE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDLATENCYBUDGET_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDGROUPENTITYID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDENTITYVIRTUALGUID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDSERVICEKIND_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDPROTOVERSION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDPRODUCTVERSION_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDISABLEPOSITIVEACKS_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDEXPECTSVIRTUALHB_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDTYPECONSISTENCY_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDTYPEOBJECT_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDTYPECODE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDVENDORID_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDENTITYNAME_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDEXPECTSACK_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDSENDQUEUESIZE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDOWNERSHIPSTRENGTH_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength = NULL;
---
>     if (mainpdu->type == FULL_RTPS_VAL) {
>         if (mainpdu->ptr.full_rtps.submsg != NULL) {
>             for (int i = 0; i < mainpdu->ptr.full_rtps.submsgcount; ++i) {
>                 if (&mainpdu->ptr.full_rtps.submsg [i] != NULL) {
>                     if (mainpdu->ptr.full_rtps.submsg [i].type > 0) {
>                         switch (mainpdu->ptr.full_rtps.submsg [i].type) {
>                         case DATAPSUB_RTPS_VAL :
>                             {
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qoscount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].type) {
>                                                     case PIDSTATUSINFO_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDKEYHASH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos->qos = NULL;
>                                         }
>                                     }
5008,5014c4413,4551
<                             }
<                             break;
<                         case PIDPERSISTENCE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.inlineqos = NULL;
>                                 }
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdatacount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].type) {
>                                                     case PIDPROTOVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPARTICIPANTGUID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDVENDORID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPARTICIPANTBUILTENDPOINTS_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDBUILTINENDPOINTSET_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDMETATRAFFICUNILOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDEFMULTILOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPARTICIPANTLIVECOUNT_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPARTICIPANTLEASE_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDEFUNILOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDMETATRAFFICMULTILOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPROPERTYLIST_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list != NULL) {
>                                                                 for (int k = 0; k < mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.listcount; ++k) {
>                                                                     if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k] != NULL) {
>                                                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name != NULL) {
>                                                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name);
>                                                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name = NULL;
>                                                                         }
>                                                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name != NULL) {
>                                                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name);
>                                                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name = NULL;
>                                                                         }
>                                                                     }
>                                                                 }
>                                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list != NULL) {
>                                                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list);
>                                                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list = NULL;
>                                                                 }
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDENTITYNAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDROLENAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPEERHOSTEPOCH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDOMAINID_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.piddomainid_rtps.domainid != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.piddomainid_rtps.domainid);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.piddomainid_rtps.domainid = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTRANSPORTINFOLIST_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info != NULL) {
>                                                                 for (int k = 0; k < mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.infocount; ++k) {
>                                                                     if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info [k] != NULL) {
>                                                                     }
>                                                                 }
>                                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info != NULL) {
>                                                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info);
>                                                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info = NULL;
>                                                                 }
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPRODUCTVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata->particdata = NULL;
>                                         }
>                                     }
5016,5022c4553,4555
<                             }
<                             break;
<                         case PIDLIFESPAN_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datapsub_rtps.serializeddata = NULL;
5026,5030c4559,4595
<                         case PIDTYPEMAXSIZESERIALIZED_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value = NULL;
---
>                         case DATASUB_RTPS_VAL :
>                             {
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qoscount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].type) {
>                                                     case PIDSTATUSINFO_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDKEYHASH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos->qos = NULL;
>                                         }
>                                     }
5032,5038c4597,4599
<                             }
<                             break;
<                         case PIDDURABILITYSERVICE_RTPS_VAL :
<                             {
<                                 if (datarsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice != NULL) {
<                                     free (datarsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice);
<                                     datarsub_rtps->serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.inlineqos = NULL;
5040,5076c4601,4603
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datarsub_rtps->serializeddata->topicdata != NULL) {
<                 free (datarsub_rtps->serializeddata->topicdata);
<                 datarsub_rtps->serializeddata->topicdata = NULL;
<             }
<         }
<     }
<     if (datarsub_rtps->serializeddata != NULL) {
<         free (datarsub_rtps->serializeddata);
<         datarsub_rtps->serializeddata = NULL;
<     }
< }
< 
< void freeGAP_RTPS (GAP_RTPS *gap_rtps) {
<     if (gap_rtps->snstate.bitmap != NULL) {
<         free (gap_rtps->snstate.bitmap);
<         gap_rtps->snstate.bitmap = NULL;
<     }
< }
< 
< void freeDATAPSUB_RTPS (DATAPSUB_RTPS *datapsub_rtps) {
<     if (datapsub_rtps->inlineqos != NULL) {
<         if (datapsub_rtps->inlineqos->qos != NULL) {
<             for (int j = 0; j < datapsub_rtps->inlineqos->qoscount; ++j) {
<                 if (&datapsub_rtps->inlineqos->qos [j] != NULL) {
<                     if (datapsub_rtps->inlineqos->qos [j].type > 0) {
<                         switch (datapsub_rtps->inlineqos->qos [j].type) {
<                         case PIDSTATUSINFO_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
<                                     free (datapsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
<                                     datapsub_rtps->inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.serializeddata != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.serializeddata);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datasub_rtps.serializeddata = NULL;
5080c4607
<                         case PIDKEYHASH_RTPS_VAL :
---
>                         case ACKNACK_RTPS_VAL :
5082,5084c4609,4611
<                                 if (datapsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
<                                     free (datapsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
<                                     datapsub_rtps->inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.acknack_rtps.readersn.bitmap != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.acknack_rtps.readersn.bitmap);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.acknack_rtps.readersn.bitmap = NULL;
5088,5112c4615
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         }
<                     }
<                 }
<             }
<             if (datapsub_rtps->inlineqos->qos != NULL) {
<                 free (datapsub_rtps->inlineqos->qos);
<                 datapsub_rtps->inlineqos->qos = NULL;
<             }
<         }
<     }
<     if (datapsub_rtps->inlineqos != NULL) {
<         free (datapsub_rtps->inlineqos);
<         datapsub_rtps->inlineqos = NULL;
<     }
<     if (datapsub_rtps->serializeddata != NULL) {
<         if (datapsub_rtps->serializeddata->particdata != NULL) {
<             for (int j = 0; j < datapsub_rtps->serializeddata->particdatacount; ++j) {
<                 if (&datapsub_rtps->serializeddata->particdata [j] != NULL) {
<                     if (datapsub_rtps->serializeddata->particdata [j].type > 0) {
<                         switch (datapsub_rtps->serializeddata->particdata [j].type) {
<                         case PIDPROTOVERSION_RTPS_VAL :
---
>                         case HEARTBEAT_RTPS_VAL :
5116c4619
<                         case PIDPARTICIPANTGUID_RTPS_VAL :
---
>                         case INFO$DST_RTPS_VAL :
5120c4623
<                         case PIDVENDORID_RTPS_VAL :
---
>                         case INFO$TS_RTPS_VAL :
5124c4627
<                         case PIDPARTICIPANTBUILTENDPOINTS_RTPS_VAL :
---
>                         case DATAWSUB_RTPS_VAL :
5126,5171c4629,4656
<                             }
<                             break;
<                         case PIDBUILTINENDPOINTSET_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDMETATRAFFICUNILOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDEFMULTILOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDPARTICIPANTLIVECOUNT_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDPARTICIPANTLEASE_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDSENTINAL_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDDEFUNILOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDMETATRAFFICMULTILOCATOR_RTPS_VAL :
<                             {
<                             }
<                             break;
<                         case PIDPROPERTYLIST_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list != NULL) {
<                                     for (int k = 0; k < datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.listcount; ++k) {
<                                         if (&datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k] != NULL) {
<                                             if (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name != NULL) {
<                                                 free (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name);
<                                                 datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].name.name = NULL;
<                                             }
<                                             if (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name != NULL) {
<                                                 free (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name);
<                                                 datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list [k].value.name = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qoscount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].type) {
>                                                     case PIDSTATUSINFO_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDKEYHASH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
5173a4659,4662
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos->qos = NULL;
>                                         }
5175,5194d4663
<                                     if (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list != NULL) {
<                                         free (datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list);
<                                         datapsub_rtps->serializeddata->particdata [j].ptr.pidpropertylist_rtps.properties.list = NULL;
<                                     }
<                                 }
<                             }
<                             break;
<                         case PIDENTITYNAME_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
<                                     free (datapsub_rtps->serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name);
<                                     datapsub_rtps->serializeddata->particdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
<                                 }
<                             }
<                             break;
<                         case PIDROLENAME_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name != NULL) {
<                                     free (datapsub_rtps->serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name);
<                                     datapsub_rtps->serializeddata->particdata [j].ptr.pidrolename_rtps.rolename.name = NULL;
5196,5202c4665,4927
<                             }
<                             break;
<                         case PIDPEERHOSTEPOCH_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch != NULL) {
<                                     free (datapsub_rtps->serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch);
<                                     datapsub_rtps->serializeddata->particdata [j].ptr.pidpeerhostepoch_rtps.hostepoch = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.inlineqos = NULL;
>                                 }
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdatacount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].type) {
>                                                     case PIDTOPICNAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPENAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDRELIABILITY_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDENDPOINTGUID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDMULTICASTLOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDUNICASTLOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDUNKNOWN_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDACKKIND_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDRECVQUEUE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTIMEBASEDFILTER_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLIVELINESS_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDURABILITY_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDIRECTCOMMUNICATION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDOWNERSHIP_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPRESENTATION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDESTINATIONORDER_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDEADLINE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLATENCYBUDGET_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDGROUPENTITYID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDENTITYVIRTUALGUID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDSERVICEKIND_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPROTOVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPRODUCTVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDISABLEPOSITIVEACKS_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDEXPECTSVIRTUALHB_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDTYPECONSISTENCY_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDTYPEOBJECT_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPECODE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDVENDORID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDENTITYNAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDEXPECTSACK_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENDQUEUESIZE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDOWNERSHIPSTRENGTH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPERSISTENCE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLIFESPAN_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPEMAXSIZESERIALIZED_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDURABILITYSERVICE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata->topicdata = NULL;
>                                         }
>                                     }
5204,5210c4929,4931
<                             }
<                             break;
<                         case PIDDOMAINID_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.piddomainid_rtps.domainid != NULL) {
<                                     free (datapsub_rtps->serializeddata->particdata [j].ptr.piddomainid_rtps.domainid);
<                                     datapsub_rtps->serializeddata->particdata [j].ptr.piddomainid_rtps.domainid = NULL;
---
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datawsub_rtps.serializeddata = NULL;
5214,5218c4935,4969
<                         case PIDTRANSPORTINFOLIST_RTPS_VAL :
<                             {
<                                 if (datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info != NULL) {
<                                     for (int k = 0; k < datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.infocount; ++k) {
<                                         if (&datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info [k] != NULL) {
---
>                         case DATARSUB_RTPS_VAL :
>                             {
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qoscount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].type) {
>                                                     case PIDSTATUSINFO_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidstatusinfo_rtps.flags = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDKEYHASH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos [j].ptr.pidkeyhash_rtps.guid = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos->qos = NULL;
5221,5223c4972,5234
<                                     if (datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info != NULL) {
<                                         free (datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info);
<                                         datapsub_rtps->serializeddata->particdata [j].ptr.pidtransportinfolist_rtps.transports.info = NULL;
---
>                                 }
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.inlineqos = NULL;
>                                 }
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata != NULL) {
>                                     if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata != NULL) {
>                                         for (int j = 0; j < mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdatacount; ++j) {
>                                             if (&mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j] != NULL) {
>                                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].type > 0) {
>                                                     switch (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].type) {
>                                                     case PIDTOPICNAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtopicname_rtps.topicname.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPENAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypename_rtps.typename.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDRELIABILITY_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidreliability_rtps.slack = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDENDPOINTGUID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDMULTICASTLOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDUNICASTLOCATOR_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDSENTINAL_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDUNKNOWN_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDACKKIND_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidackkind_rtps.ackkind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDRECVQUEUE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidrecvqueue_rtps.queuesize = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTIMEBASEDFILTER_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtimebasedfilter_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLIVELINESS_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidliveliness_rtps.liveliness = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDURABILITY_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurability_rtps.durability = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDIRECTCOMMUNICATION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDOWNERSHIP_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownership_rtps.kind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPRESENTATION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDESTINATIONORDER_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddestinationorder_rtps.kind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDEADLINE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddeadline_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLATENCYBUDGET_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlatencybudget_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDGROUPENTITYID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDENTITYVIRTUALGUID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDSERVICEKIND_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidservicekind_rtps.servicekind = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPROTOVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDPRODUCTVERSION_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDDISABLEPOSITIVEACKS_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDEXPECTSVIRTUALHB_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDTYPECONSISTENCY_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDTYPEOBJECT_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypeobject_rtps.typeobject = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPECODE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypecode_rtps.typeobjectcode = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDVENDORID_RTPS_VAL :
>                                                         {
>                                                         }
>                                                         break;
>                                                     case PIDENTITYNAME_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidentityname_rtps.entityname.name = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDEXPECTSACK_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidexpectsack_rtps.expectsack = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDSENDQUEUESIZE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidsendqueuesize_rtps.queuesize = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDOWNERSHIPSTRENGTH_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidownershipstrength_rtps.strength = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDPERSISTENCE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidpersistence_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDLIFESPAN_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidlifespan_rtps.leaseduration = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDTYPEMAXSIZESERIALIZED_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.pidtypemaxsizeserialized_rtps.value = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     case PIDDURABILITYSERVICE_RTPS_VAL :
>                                                         {
>                                                             if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice != NULL) {
>                                                                 free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice);
>                                                                 mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata [j].ptr.piddurabilityservice_rtps.durabilityservice = NULL;
>                                                             }
>                                                         }
>                                                         break;
>                                                     }
>                                                 }
>                                             }
>                                         }
>                                         if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata != NULL) {
>                                             free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata);
>                                             mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata->topicdata = NULL;
>                                         }
5225a5237,5240
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.datarsub_rtps.serializeddata = NULL;
>                                 }
5228c5243
<                         case PIDPRODUCTVERSION_RTPS_VAL :
---
>                         case GAP_RTPS_VAL :
5229a5245,5248
>                                 if (mainpdu->ptr.full_rtps.submsg [i].ptr.gap_rtps.snstate.bitmap != NULL) {
>                                     free (mainpdu->ptr.full_rtps.submsg [i].ptr.gap_rtps.snstate.bitmap);
>                                     mainpdu->ptr.full_rtps.submsg [i].ptr.gap_rtps.snstate.bitmap = NULL;
>                                 }
5236,5238c5255,5257
<             if (datapsub_rtps->serializeddata->particdata != NULL) {
<                 free (datapsub_rtps->serializeddata->particdata);
<                 datapsub_rtps->serializeddata->particdata = NULL;
---
>             if (mainpdu->ptr.full_rtps.submsg != NULL) {
>                 free (mainpdu->ptr.full_rtps.submsg);
>                 mainpdu->ptr.full_rtps.submsg = NULL;
5242,5252d5260
<     if (datapsub_rtps->serializeddata != NULL) {
<         free (datapsub_rtps->serializeddata);
<         datapsub_rtps->serializeddata = NULL;
<     }
< }
< 
< void freePDU_RTPS (PDU_RTPS *mainpdu) {
<     if (mainpdu->type == PING_RTPS_VAL) {
<     }
<     if (mainpdu->type == FULL_RTPS_VAL) {
<     }
5398,5444d5405
< }
< 
< bool walk_SUBMESSAGE_RTPS (FULL_RTPS *full_rtps, SUBMESSAGE_RTPS *submsg, PDU *thePDU) {
<     uint32_t type;
<     for (int i = 0; i < full_rtps->submsgcount; i++) {
<         type = submsg[i].type;
<         switch (type) {
<         case DATASUB_RTPS_VAL :
<             DATASUB_RTPS_callback (full_rtps, &submsg[i].ptr.datasub_rtps, thePDU);
<             freeDATASUB_RTPS (&submsg[i].ptr.datasub_rtps);
<             break;
<         case DATAWSUB_RTPS_VAL :
<             DATAWSUB_RTPS_callback (full_rtps, &submsg[i].ptr.datawsub_rtps, thePDU);
<             freeDATAWSUB_RTPS (&submsg[i].ptr.datawsub_rtps);
<             break;
<         case DATAPSUB_RTPS_VAL :
<             DATAPSUB_RTPS_callback (full_rtps, &submsg[i].ptr.datapsub_rtps, thePDU);
<             freeDATAPSUB_RTPS (&submsg[i].ptr.datapsub_rtps);
<             break;
<         case DATARSUB_RTPS_VAL :
<             DATARSUB_RTPS_callback (full_rtps, &submsg[i].ptr.datarsub_rtps, thePDU);
<             freeDATARSUB_RTPS (&submsg[i].ptr.datarsub_rtps);
<             break;
<         case INFO$DST_RTPS_VAL :
<             INFO$DST_RTPS_callback (full_rtps, &submsg[i].ptr.info$dst_rtps, thePDU);
<             freeINFO$DST_RTPS (&submsg[i].ptr.info$dst_rtps);
<             break;
<         case INFO$TS_RTPS_VAL :
<             INFO$TS_RTPS_callback (full_rtps, &submsg[i].ptr.info$ts_rtps, thePDU);
<             freeINFO$TS_RTPS (&submsg[i].ptr.info$ts_rtps);
<             break;
<         case ACKNACK_RTPS_VAL :
<             ACKNACK_RTPS_callback (full_rtps, &submsg[i].ptr.acknack_rtps, thePDU);
<             freeACKNACK_RTPS (&submsg[i].ptr.acknack_rtps);
<             break;
<         case HEARTBEAT_RTPS_VAL :
<             HEARTBEAT_RTPS_callback (full_rtps, &submsg[i].ptr.heartbeat_rtps, thePDU);
<             freeHEARTBEAT_RTPS (&submsg[i].ptr.heartbeat_rtps);
<             break;
<         case GAP_RTPS_VAL :
<             GAP_RTPS_callback (full_rtps, &submsg[i].ptr.gap_rtps, thePDU);
<             freeGAP_RTPS (&submsg[i].ptr.gap_rtps);
<             break;
<         default :
<             return false;
<         }
<     }
